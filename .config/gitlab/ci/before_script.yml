---
before_script:
  - sudo apt update
  - sudo apt-get install -y --no-install-recommends pipx
  - pipx ensurepath
  - pipx install uv
  - uv python install $(cut -d '=' -f 2 .config/python/.python-version)
  # Install Taskfile if not present
  - |
    if ! command -v task &> /dev/null; then
      echo "Taskfile not found. Installation in progress..."
      sh -c "$(curl --location https://taskfile.dev/install.sh)" -- -d -b /usr/local/bin
    else
      echo "Taskfile already installed."
    fi
    task --version
  # Execute the initialization Taskfile
  - task dev:init
  # Source bash profile (optional; only if present)
  - test -f ~/.bash_profile && . ~/.bash_profile || true
