---
version: "3"

vars:
  TASK_DEVSECOPS_FEEDBACK_ENABLED: '{{.TASK_DEVSECOPS_FEEDBACK_ENABLED | default "true"}}'
  TASK_DEVSECOPS_FEEDBACK_RENOVATE_ENABLED: '{{.TASK_DEVSECOPS_FEEDBACK_RENOVATE_ENABLED | default "true"}}'

tasks:
  default:
    desc: Run all generic feedback tasks
    status:
      - test "{{.TASK_DEVSECOPS_FEEDBACK_ENABLED}}" = "false"
    cmds:
      - cmd: echo "ðŸ”„ Starting feedback phase"
        silent: true
      - task: :project:feedback
      - task: renovate
      - cmd: echo "ðŸŽ‰ Feedback phase completed successfully"
        silent: true

  renovate:
    desc: Run Renovate as part of feedback (skipped unless enabled)
    status:
      - test "{{.TASK_DEVSECOPS_FEEDBACK_RENOVATE_ENABLED}}" != "true" || test -z "$RENOVATE_TOKEN"
    cmds:
      - task: :renovate
