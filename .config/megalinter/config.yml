---
APPLY_FIXES:
  - JSON_PRETTIER
  - YAML_PRETTIER

DISABLE_LINTERS:
  - JSON_V8R
  - YAML_V8R
  - COPYPASTE_JSCPD

EXCLUDED_DIRECTORIES:
  - megalinter-reports
  - vendor
  - venv
  - .git
  - .config/podman/roles

ANSIBLE_ANSIBLE_LINT_CONFIG_FILE: .config/ansible-lint/config.yaml
COPYPASTE_JSCPD_CONFIG_FILE: .config/jscpd/config.json
GHERKIN_GHERKIN_LINT_CONFIG_FILE: .config/gherkin-lint/config.json
REPOSITORY_DEVSKIM_CONFIG_FILE: .config/devskim/config.json
REPOSITORY_GITLEAKS_CONFIG_FILE: .config/gitleaks/config.toml
REPOSITORY_GRYPE_CONFIG_FILE: .config/grype/config.yml
REPOSITORY_KICS_CONFIG_FILE: .config/kics/config.yml
REPOSITORY_TRIVY_CONFIG_FILE: .config/trivy/config.yml
SPELL_CSPELL_CONFIG_FILE: .config/cspell/config.json
SPELL_LYCHEE_CONFIG_FILE: .config/lychee/config.toml
SPELL_LYCHEE_FILTER_REGEX_EXCLUDE: '(package-lock\.json)'
YAML_YAMLLINT_CONFIG_FILE: .config/yamllint/config.yml
REPOSITORY_DUSTILOCK_ARGUMENTS: "--path project"

SHOW_ELAPSED_TIME: true
SARIF_REPORTER: true
CLEAR_REPORT_FOLDER: true
PARALLEL_PROCESS_NUMBER: 2 # Limiting to 2 cores is necessary to prevent Dustilock or Checkov from crashing.

PRE_COMMANDS:
  - command: rm -rf /tmp/lint/venv
  - command: rm -rf /tmp/lint/megalinter-reports
  - command: rm -rf /tmp/lint/tmp
  - command: rm -rf /tmp/lint/.config/docker-ce
  - command: rm -rf /tmp/lint/.config/helm
  - command: rm -rf /tmp/lint/.config/podman
  - command: rm -rf /tmp/lint/.config/go
  - command: rm -rf /tmp/lint/.config/nodejs
  - command: find /tmp/lint/.config -type d -name "roles" -exec rm -rf {} +
  - command: find /tmp/lint/.config -type d -name "node_modules" -exec rm -rf {} +
  - command: find /tmp/lint/ -type f \( -name "kubeconfig.yml" -o -name "kubeconfig.yaml" \) -exec rm -f {} \;
  - command: find /tmp/lint/ -type f \( -name "secrets.yml" -o -name "secrets.yaml" \) -exec rm -f {} \;
  - command: find /tmp/lint/.config/ -type f -name "package-lock.json" -exec rm -f {} \;
  - command: rm -f /tmp/lint/project/public/helm/index.yaml
  - command: find /tmp/lint/ -type f -name "*.tgz" -exec rm -f {} \;
  - command: |
      npm install -g \
        @cspell/dict-companies \
        @cspell/dict-en-gb \
        @cspell/dict-fr-fr \
        @cspell/dict-python \
        @cspell/dict-software-terms

POST_COMMANDS:
  - command: chmod -R 777 /tmp/lint/megalinter-reports

# Ignore only import errors E0401
PYTHON_PYLINT_ARGUMENTS:
  - --disable=E0401
# Create a pyrightconfig.json file to ignore import errors
PYTHON_PYRIGHT_PRE_COMMANDS:
  - command: |
      echo '{
        "reportMissingImports": false,
        "reportMissingModuleSource": false
      }' > pyrightconfig.json
    continue_if_failed: false
